(function(e){function i(i){for(var a,n,r=i[0],l=i[1],c=i[2],p=0,u=[];p<r.length;p++)n=r[p],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&u.push(s[n][0]),s[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);d&&d(i);while(u.length)u.shift()();return o.push.apply(o,c||[]),t()}function t(){for(var e,i=0;i<o.length;i++){for(var t=o[i],a=!0,r=1;r<t.length;r++){var l=t[r];0!==s[l]&&(a=!1)}a&&(o.splice(i--,1),e=n(n.s=t[0]))}return e}var a={},s={app:0},o=[];function n(i){if(a[i])return a[i].exports;var t=a[i]={i:i,l:!1,exports:{}};return e[i].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=a,n.d=function(e,i,t){n.o(e,i)||Object.defineProperty(e,i,{enumerable:!0,get:t})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,i){if(1&i&&(e=n(e)),8&i)return e;if(4&i&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&i&&"string"!=typeof e)for(var a in e)n.d(t,a,function(i){return e[i]}.bind(null,a));return t},n.n=function(e){var i=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(i,"a",i),i},n.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},n.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=i,r=r.slice();for(var c=0;c<r.length;c++)i(r[c]);var d=l;o.push([0,"chunk-vendors"]),t()})({0:function(e,i,t){e.exports=t("56d7")},"034f":function(e,i,t){"use strict";var a=t("3ebb"),s=t.n(a);s.a},"104f":function(e,i){var t='<p>This report contains the security assessment results from <a href="https://github.com/salesforce/cloudsplaining">Cloudsplaining</a> - a tool that helps manage your IAM risk landscape by scanning your AWS account and creating a risk-prioritized HTML report.</p> <p>The report shows the following:</p> <ul> <li><p><strong>High priority risks</strong> in IAM policies, like Privilege Escalation, Resource Exposure, Infrastructure Modification, and Data Exfiltration.</p> </li> <li><p><strong>Violations of Least Privilege</strong>: Identifies where resource ARN constraints are not used</p> </li> <li><p><strong>EC2 Instance Profile usage</strong>: If a Compute Service role (like an EC2 instance profile) leverages the policy</p> </li> <li><p><strong>Policies view:</strong> Shows all policy types (<a href="#customer-managed-policy">Customer-Managed Policies</a>, <a href="#inline-policy">Inline Policies</a>, and <a href="#aws-managed-policy">AWS-Managed Policies</a>) and their associated findings</p> </li> <li><p><strong>Principals view</strong>: To view the list of IAM Principals and their associated policies, see the <a href="#nav-principals">IAM Principals Tab</a>.</p> </li> <li><p><strong>Exclusions</strong>: Considers user-supplied exclusions from the command line arguments. If there are no findings for a particular policy, or if the policy is not attached to any IAM Principals, then the policy is not included. Please refer to the <a href="#exclusions">Exclusions configuration</a> to see which ones were excluded.</p> </li> <li><p><strong>Extensive Triaging and Remediation Guidance</strong>: For more information, see the <a href="#remediation-prioritization">Prioritization Guidance</a> and <a href="#triage-triaging-considerations">Triaging Considerations</a>. Consider using all of the Guidance criteria when reviewing this report as well.</p> </li> </ul> <p>Remediating these issues, where appropriate, will help to limit the blast radius in the case of compromised AWS credentials.</p> ';e.exports=t},"1ec7":function(e,i){var t='<p>This report contains the security assessment results from <a href="https://github.com/salesforce/cloudsplaining">Cloudsplaining</a>, which maps out the IAM risk landscape in a report, identifies where resource ARN constraints are not used, and identifies other risks in IAM policies like <a href="#definition-privilege-escalation">Privilege Escalation</a>, <a href="#definition-resource-exposure">Resource Exposure</a>, <a href="#definition-infrastructure-modification">Infrastructure Modification</a>, and <a href="#definition-data-exfiltration">Data Exfiltration</a>. Remediating these issues, where necessary, will help to limit the blast radius in the case of compromised AWS credentials.</p> ';e.exports=t},"1ff4":function(e,i,t){"use strict";t("99af"),t("a630"),t("fb6a"),t("b64b"),t("d3b7"),t("ac1f"),t("6062"),t("3ca3"),t("1276"),t("ddb0");var a=t("6374"),s=t("bb52"),o=t("e56f");function n(e){return Object.keys(e["inline_policies"])}function r(e,i){return Object.assign(e["inline_policies"][i])}function l(e,i){return e["inline_policies"][i]["PolicyName"].slice()}function c(e,i){return Object.assign(e["inline_policies"][i]["PolicyDocument"])}function d(e,i,t){return Object.assign(e["inline_policies"][i][t])}function p(e,i){var t=[],s=Array.from(e["inline_policies"][i]["InfrastructureModification"]);if(s.length>0){var o,n,r=a(s);try{for(r.s();!(n=r.n()).done;){o=n.value;var l=o.split(":")[0];l in t||t.push(l)}}catch(c){r.e(c)}finally{r.f()}return Array.from(new Set(t)).sort()}return[]}function u(e,i){var t;t=Object.keys(e["roles"]);for(var a=[],s=0;s<t.length;s++){var o=t[s],n=Object.assign(e["roles"][o]["inline_policies"]);Object.prototype.hasOwnProperty.call(n,i)&&a.push(o)}return a}function g(e,i){var t;t=Object.keys(e["groups"]);for(var a=[],s=0;s<t.length;s++){var o=t[s],n=Object.assign(e["groups"][o]["inline_policies"]);Object.prototype.hasOwnProperty.call(n,i)&&a.push(o)}return a}function m(e,i){var t;t=Object.keys(e["users"]);for(var a=[],s=0;s<t.length;s++){var o=t[s],n=Object.assign(e["users"][o]["inline_policies"]);Object.prototype.hasOwnProperty.call(n,i)&&a.push(o)}return a}function h(e,i,t){return"Role"===t?u(e,i):"Group"===t?g(e,i):"User"===t?m(e,i):void 0}function f(e,i){var t,a,s;return t=m(e,i),a=u(e,i),s=g(e,i),t.concat(s,a)}function y(e,i){var t=u(e,i);if(!t.length>0)return[];for(var a=[],o=0;o<t.length;o++){var n=s.getTrustPolicyDocumentForRole(e,t[o]),r=s.trustPolicyAssumableByComputeService(n);if(r.length>0)for(var l=0;l<r.length;l++)r[l]in a||a.push(r[l])}return a}function v(e,i){var t,s=[],o=a(i);try{for(o.s();!(t=o.n()).done;){var n=t.value,r=l(e,n),c=f(e,n),u=p(e,n).length,g=d(e,n,"InfrastructureModification").length,m=d(e,n,"PrivilegeEscalation").length,h=d(e,n,"ResourceExposure").length,v=d(e,n,"DataExfiltration").length,b=y(e,n),_={policy_name:r,attached_to_principals:c,services:u,privilege_escalation:m,resource_exposure:h,data_exfiltration:v,infrastructure_modification:g,compute_role:b};s.push(_)}}catch(P){o.e(P)}finally{o.f()}return s}function b(e){var i,t,s=n(e),r=[],l=a(s);try{for(l.s();!(t=l.n()).done;){i=t.value;var c=e["inline_policies"][i]["PolicyName"].slice();r.push({policy_name:c,policy_id:i})}}catch(d){l.e(d)}finally{l.f()}return r.sort(o.compareValues("policy_name","asc")),v(e,s)}i.getInlinePolicyIds=n,i.getInlinePolicy=r,i.getInlinePolicyDocument=c,i.getInlinePolicyFindings=d,i.getServicesAffectedByInlinePolicy=p,i.getRolesLeveragingInlinePolicy=u,i.getGroupsLeveragingInlinePolicy=g,i.getUsersLeveragingInlinePolicy=m,i.getPrincipalTypeLeveragingInlinePolicy=h,i.getAllPrincipalTypesLeveragingInlinePolicy=f,i.inlinePolicyAssumableByComputeService=y,i.getInlinePolicyItems=v,i.getInlinePolicyNameMapping=b},"3ebb":function(e,i,t){var a=t("e31a");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var s=t("499e").default;s("517436b3",a,!0,{sourceMap:!1,shadowMode:!1})},"43be":function(e,i,t){"use strict";function a(e){return Object.keys(e["groups"])}function s(e,i){var t;t=Object.keys(e["users"]);for(var a=[],s=0;s<t.length;s++){var o=t[s],n=e["users"][o]["groups"];Object.prototype.hasOwnProperty.call(n,i)&&a.push(o)}return a}t("b64b"),i.getGroupNames=a,i.getGroupMembers=s},4678:function(e,i,t){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(e){var i=o(e);return t(i)}function o(e){if(!t.o(a,e)){var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=o,e.exports=s,s.id="4678"},"51d3":function(e,i){var t='<p>These policies allow a combination of IAM actions that allow a principal with these permissions to escalate their privileges - for example, by creating an access key for another IAM user, or modifying their own permissions. This research was pioneered by Spencer Gietzen at Rhino Security Labs.  Remediation guidance can be found <a href="https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/">here</a>.</p>',a='<div style="text-align:left"><p>Policies with Data Exfiltration potential allow certain read-only IAM actions without resource constraints, such as <code>s3:GetObject</code>, <code>ssm:GetParameter*</code>, or <code>secretsmanager:GetSecretValue</code>. <br> <ul> <li>Unrestricted <code>s3:GetObject</code> permissions has a long history of customer data leaks.</li> <li><code>ssm:GetParameter*</code> and <code>secretsmanager:GetSecretValue</code> are both used to access secrets.</li> <li><code>rds:CopyDBSnapshot</code> and <code>rds:CreateDBSnapshot</code> can be used to exfiltrate RDS database contents.</li> </ul></p></div>',s='<p>Resource Exposure actions allow modification of Permissions to <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_identity-vs-resource.html">resource-based policies</a> or otherwise can expose AWS resources to the public via similar actions that can lead to resource exposure - for example, the ability to modify <a href="https://docs.aws.amazon.com/ram/latest/userguide/what-is.html">AWS Resource Access Manager</a>.</p>',o="<p>IAM Roles can be assumed by AWS Compute Services (such as EC2, ECS, EKS, or Lambda) can present greater risk than user-defined roles, especially if the AWS Compute service is on an instance that is directly or indirectly exposed to the internet. Flagging these roles is particularly useful to penetration testers (or attackers) under certain scenarios.<br>For example, if an attacker obtains privileges to execute <code>ssm:SendCommand</code> and there are privileged EC2 instances with the SSM agent installed, they can effectively have the privileges of those EC2 instances.</p>",n={PrivilegeEscalation:t,DataExfiltration:a,ResourceExposure:s,AssumableByComputeService:o};function r(e){return n[e]}i.getRiskDefinition=r},"557f":function(e,i){var t='<h5 id="impact">Impact</h5> <p>The impact the risk would have on an organization if such a vulnerability were successfully exploited is rated according to criteria listed below. Note that these ratings are based on NIST 800-30 impact definitions.</p> <ul> <li><strong>Critical</strong>: The issue causes multiple severe or catastrophic effects on operations, assets or other organizations.</li> <li><strong>High</strong>: Causes produces severe degradation in mission capability to the point that the organization is not able to perform primary functions or results in damage to organizational assets.</li> <li><strong>Medium</strong>: Trigger degradation in mission capability to an extent the application is able to perform its primary functions, but their effectiveness is reduced and there may be damage to the organization&#39;s assets.</li> <li><strong>Low</strong>: Results in limited degradation in mission capability; the organization is able to perform its primary functions, but their effectiveness is noticeably reduced and may result in minor damage to the organization&#39;s assets.</li> </ul> <h5 id="privilege-escalation">Privilege Escalation</h5> <p>These policies allow a combination of IAM actions that allow a principal with these permissions to escalate their privileges - for example, by creating an access key for another IAM user, or modifying their own permissions. This research was pioneered by <a href="https://twitter.com/SpenGietz">Spencer Gietzen</a> at Rhino Security Labs. Remediation Guidance can be found <a href="https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/">here</a>.</p> <h5 id="resource-exposure">Resource Exposure</h5> <p>Resource Exposure actions allow modification of Permissions to <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_identity-vs-resource.html">resource-based policies</a> or otherwise can expose AWS resources to the public via similar actions that can lead to resource exposure - for example, the ability to modify <a href="https://docs.aws.amazon.com/ram/latest/userguide/what-is.html">AWS Resource Access Manager</a>.</p> <h5 id="infrastructure-modification">Infrastructure Modification</h5> <p>Infrastructure Modification describes IAM actions with &quot;modify&quot; capabilities, and can therefore lead to <a href="https://attack.mitre.org/techniques/T1496/">Resource Hijacking</a>, unauthorized creation of Infrastructure, Backdoor creation, and/or modification of existing resources which can result in downtime.</p> <h5 id="data-exfiltration">Data Exfiltration</h5> <p>Policies with Data Exfiltration potential allow certain read-only IAM actions without resource constraints, such as <code>s3:GetObject</code>, <code>ssm:GetParameter*</code>, or <code>secretsmanager:GetSecretValue</code>. Unrestricted <code>s3:GetObject</code> permissions has a long history of customer data leaks. <code>ssm:GetParameter*</code> and <code>secretsmanager:GetSecretValue</code> are both used to access secrets. <code>rds:CopyDBSnapshot</code> and <code>rds:CreateDBSnapshot</code> can be used to exfiltrate RDS database contents.</p> <h5 id="roles-assumable-by-compute-services">Roles Assumable by Compute Services</h5> <p>IAM Roles can be assumed by AWS Compute Services (such as EC2, ECS, EKS, or Lambda) can present greater risk than user-defined roles, especially if the AWS Compute service is on an instance that is directly or indirectly exposed to the internet. Flagging these roles is particularly useful to penetration testers (or attackers) under certain scenarios. For example, if an attacker obtains privileges to execute <a href="https://docs.aws.amazon.com/systems-manager/latest/APIReference/API_SendCommand.html">ssm:SendCommand</a> and there are privileged EC2 instances with the SSM agent installed, they can effectively have the privileges of those EC2 instances. Remote Code Execution via AWS Systems Manager Agent was already a known escalation/exploitation path, but Cloudsplaining can make the process of identifying theses cases easier.</p> <h5 id="trust-policy">Trust Policy</h5> <p>A JSON policy document in which you define the principals that you trust to assume the role. A role trust policy is a required resource-based policy that is attached to a role in IAM. The principals that you can specify in the trust policy include users, roles, accounts, and services.</p> <p>This definition was taken from the AWS Documentation <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#term_trust-policy">here</a>.</p> <h5 id="principal">Principal</h5> <p>An entity in AWS that can perform actions and access resources. A principal can be an AWS account root user, an IAM user, or a role.</p> <h5 id="role">Role</h5> <p>An IAM identity that you can create in your account that has specific permissions. An IAM role has some similarities to an IAM user. Roles and users are both AWS identities with permissions policies that determine what the identity can and cannot do in AWS. However, instead of being uniquely associated with one person, a role is intended to be assumable by anyone who needs it. Also, a role does not have standard long-term credentials such as a password or access keys associated with it. Instead, when you assume a role, it provides you with temporary security credentials for your role session.</p> <p>We are particularly interested in roles used for <strong>compute services</strong> - i.e., Compute Service Roles.</p> <p>This definition was taken from the AWS Documentation <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-role">here</a>.</p> <h5 id="managed-policy">Managed Policy</h5> <p>There are two types of Managed Policies: AWS-managed policies and Customer-managed policies. They are described below.</p> <p>Criteria for selecting Managed Policies versus Inline policies can be found in the AWS documentation <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#choosing-managed-or-inline">here</a>.</p> <h5 id="customer-managed-policy">Customer-managed policy</h5> <p>AWS documentation on Customer-managed policies can be found <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#customer-managed-policies">here</a>.</p> <p>The following diagram illustrates customer managed policies. Each policy is an entity in IAM with its own Amazon Resource Name (ARN) that includes the policy name. Notice that the same policy can be attached to multiple principal entities—for example, the same DynamoDB-books-app policy is attached to two different IAM roles.</p> <p><img src="https://docs.aws.amazon.com/IAM/latest/UserGuide/images/policies-customer-managed-policies.diagram.png" alt="Customer-managed policy diagram"></p> <h5 id="aws-managed-policy">AWS-managed policy</h5> <p>An AWS managed policy is a standalone policy that is created and administered by AWS. Standalone policy means that the policy has its own Amazon Resource Name (ARN) that includes the policy name. For example, <code>arn:aws:iam::aws:policy/IAMReadOnlyAccess</code> is an AWS managed policy.</p> <p>AWS documentation on AWS-managed policies can be found <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#aws-managed-policies">here</a>.</p> <p>The following diagram (taken from the AWS documentation) illustrates AWS managed policies. The diagram shows three AWS managed policies: AdministratorAccess, PowerUserAccess, and AWSCloudTrailReadOnlyAccess. Notice that a single AWS managed policy can be attached to principal entities in different AWS accounts, and to different principal entities in a single AWS account.</p> <p><img src="https://docs.aws.amazon.com/IAM/latest/UserGuide/images/policies-aws-managed-policies.diagram.png" alt="AWS-managed policy diagram"></p> <h5 id="inline-policy">Inline Policy</h5> <p>An inline policy is a policy that&#39;s embedded in an IAM identity (a user, group, or role). That is, the policy is an inherent part of the identity. You can create a policy and embed it in a identity, either when you create the identity or later.</p> <p>AWS documentation on inline policies can be found <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#inline-policies">here</a>.</p> <p>The following diagram illustrates inline policies. Each policy is an inherent part of the user, group, or role. Notice that two roles include the same policy (the DynamoDB-books-app policy), but they are not sharing a single policy; each role has its own copy of the policy.</p> <p><img src="https://docs.aws.amazon.com/IAM/latest/UserGuide/images/policies-inline-policies.diagram.png" alt="Inline policy diagram"></p> <p>Inline policies are useful if you want to maintain a strict one-to-one relationship between a policy and the identity that it&#39;s applied to. For example, you want to be sure that the permissions in a policy are not inadvertently assigned to an identity other than the one they&#39;re intended for. When you use an inline policy, the permissions in the policy cannot be inadvertently attached to the wrong identity. In addition, when you use the AWS Management Console to delete that identity, the policies embedded in the identity are deleted as well. That&#39;s because they are part of the principal entity.</p> ';e.exports=t},"56d7":function(e,i,t){"use strict";t.r(i);t("e260"),t("e6cf"),t("cca6"),t("a79d");var a,s,o=t("2b0e"),n=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{attrs:{id:"main"}},[t("b-navbar",{attrs:{toggleable:"md",variant:"faded"}},[t("b-navbar-brand",{attrs:{href:"#"},on:{click:function(i){e.activeSection=0}}},[t("img",{staticClass:"d-inline-block align-top",attrs:{src:"https://placekitten.com/g/30/30",alt:"Kitten"}}),e._v(" Cloudsplaining ")]),t("b-navbar-toggle",{attrs:{target:"nav-collapse"}}),t("b-collapse",{attrs:{id:"nav-collapse","is-nav":""}},[t("b-navbar-nav",[t("b-nav-item",{attrs:{active:"custom-policies"===e.activeSection,href:"#"},on:{click:function(i){e.activeSection=1}}},[e._v("Customer Policies ")]),t("b-nav-item",{attrs:{active:"inline-policies"===e.activeSection,href:"#"},on:{click:function(i){e.activeSection=2}}},[e._v("Inline Policies ")]),t("b-nav-item",{attrs:{active:"aws-policies"===e.activeSection,href:"#"},on:{click:function(i){e.activeSection=3}}},[e._v("AWS Policies ")]),t("b-nav-item",{attrs:{active:"iam-principals"===e.activeSection,href:"#"},on:{click:function(i){e.activeSection=4}}},[e._v("IAM Principals ")]),t("b-nav-item",{attrs:{active:"guidance"===e.activeSection,href:"#"},on:{click:function(i){e.activeSection=5}}},[e._v("Guidance ")]),t("b-nav-item",{attrs:{active:"appendices"===e.activeSection,href:"#"},on:{click:function(i){e.activeSection=6}}},[e._v("Appendices ")]),t("b-nav-item",{attrs:{active:"task-table"===e.activeSection,href:"#"},on:{click:function(i){e.activeSection=7}}},[e._v("Task Table Demo ")])],1),t("b-navbar-nav",{staticClass:"ml-auto"},[t("b-nav-text",[t("strong",[e._v("Account ID")]),e._v(" 123456789012")])],1)],1)],1),t("b-container",{staticClass:"mt-3 pb-3 report"},[t("b-tabs",{attrs:{"nav-class":"d-none"},model:{value:e.activeSection,callback:function(i){e.activeSection=i},expression:"activeSection"}},[t("b-tab",{key:"summary"},[t("Summary",{attrs:{iam_data:e.iam_data,"policy-filter":e.policyFilter}})],1),t("b-tab",{key:"custom-policies"},[t("h3",[e._v("Customer-Managed Policies")]),t("PolicyTable",{attrs:{policyNameMapping:e.getManagedPolicyNameMapping("Customer")}}),t("ManagedPolicies",{attrs:{iam_data:e.iam_data,managedBy:"Customer"}})],1),t("b-tab",{key:"inline-policies"},[t("h3",[e._v("Inline Policies")]),t("PolicyTable",{attrs:{policyNameMapping:e.getInlinePolicyNameMapping()}}),t("InlinePolicies",{attrs:{iam_data:e.iam_data}})],1),t("b-tab",{key:"aws-policies"},[t("h3",[e._v("AWS-Managed Policies")]),t("PolicyTable",{attrs:{policyNameMapping:e.getManagedPolicyNameMapping("AWS")}}),t("ManagedPolicies",{attrs:{iam_data:e.iam_data,managedBy:"AWS"}})],1),t("b-tab",{key:"iam-principals"},[t("Principals",{attrs:{iam_data:e.iam_data}})],1),t("b-tab",{key:"guidance"},[t("Guidance")],1),t("b-tab",{attrs:{id:"appendices"}},[t("Glossary")],1),t("b-tab",{key:"task-table"},[t("br"),t("h3",[e._v("Tasks (demo WIP)")]),t("br"),t("h3",[e._v("AWS-Managed Policies")]),t("TaskTable",{attrs:{managedBy:"AWS",items_mapping:e.getTaskTableMapping("AWS")}})],1)],1)],1),t("b-container",[t("b-row",{staticClass:"mt-5"},[t("b-col",{staticClass:"text-center text-muted"},[e._v(" Report Generated: 2020-08-06 ⋄ Cloudsplaining version: "),t("b-link",{attrs:{href:"https://github.com/salesforce/cloudsplaining"}},[e._v("0.1.6")])],1)],1)],1)],1)},r=[],l=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"report"},[t("b-row",{staticClass:"mb-3"},[t("b-col",[t("h3",[e._v("Executive Summary")]),t("p",[e._v(" This report contains the security assessment results from "),t("a",{attrs:{href:"https://github.com/salesforce/cloudsplaining",rel:"noreferrer"}},[e._v("Cloudsplaining")]),e._v(", which maps out the IAM risk landscape in a report.")]),t("p",[e._v(" The assessment identifies where resource ARN constraints are not used and identifies other risks in IAM policies: ")]),t("ul",[t("li",[e._v("Privilege Escalation")]),t("li",[e._v("Resource Exposure")]),t("li",[e._v("Infrastructure Modification")]),t("li",[e._v("Data Exfiltration")])]),t("p",[e._v(" Remediating these issues, where necessary, will help to limit the blast radius in the case of compromised AWS credentials. ")])])],1),t("b-row",{staticClass:"mb-3"},[t("b-col",{attrs:{lg:"8"}},[t("div",{staticClass:"d-none d-sm-block"},[t("summary-findings",{attrs:{"inline-policy-risks":e.inlinePolicyRisks,"managed-policy-risks":e.managedPolicyRisks,height:200}})],1)]),t("b-col",[t("b-table-simple",{attrs:{small:"",responsive:""}},[t("b-thead",{attrs:{"head-variant":"dark"}},[t("b-tr",[t("b-th",[e._v("Risk")]),t("b-th",[e._v("Instances")]),t("b-th",[e._v("Severity")])],1)],1),t("b-tbody",[t("b-tr",[t("b-th",[e._v("Privilege Escalation")]),t("b-td",[e._v(e._s(e.policyRisks.PrivilegeEscalation))]),t("b-td",[e._v("high")])],1),t("b-tr",[t("b-th",[e._v("Data Exfiltration")]),t("b-td",[e._v(e._s(e.policyRisks.DataExfiltration))]),t("b-td",[e._v("med")])],1),t("b-tr",[t("b-th",[e._v("Resource Exposure")]),t("b-td",[e._v(e._s(e.policyRisks.ResourceExposure))]),t("b-td",[e._v("med")])],1),t("b-tr",[t("b-th",[e._v("Infrastructure Modification")]),t("b-td",[e._v(e._s(e.policyRisks.InfrastructureModification))]),t("b-td",[e._v("low")])],1)],1)],1)],1)],1)],1)},c=[],d=(t("c975"),t("07ac"),t("1fca")),p={name:"SummaryFindings",extends:d["a"],props:["inlinePolicyRisks","managedPolicyRisks"],computed:{myStyles:function(){return{height:"100%"}}},data:function(){return{chartData:{labels:["Privilege Escalation","Data Exfiltration","Resource Exposure","Infrastructure Modification"],datasets:[{label:"Inline Policies",data:Object.values(this.inlinePolicyRisks),backgroundColor:["#f87979","#f87979","#f87979","#f87979"]},{label:"Managed Policies",data:Object.values(this.managedPolicyRisks),backgroundColor:["#2247c6","#2247c6","#2247c6","#2247c6","#2247c6"]}]},options:{responsive:!0,legend:{display:!0,position:"bottom"},scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]}}}},mounted:function(){this.renderChart(this.chartData,this.options)}},u=p,g=t("2877"),m=Object(g["a"])(u,a,s,!1,null,"a6aefa16",null),h=m.exports,f=t("e56f"),y={name:"Summary",props:{iam_data:Object,policyFilter:String},components:{SummaryFindings:h},computed:{inlinePolicyRisks:function(){return Object(f["policyViolations"])(Object.assign(this.iam_data["inline_policies"]))},managedPolicyRisks:function(){return Object(f["policyViolations"])(Object.assign(this.iam_data["aws_managed_policies"],this.iam_data["customer_managed_policies"]))},policyRisks:function(){return"inlinePolicies"===this.policyFilter?this.inlinePolicyRisks:-1!==["custManaged","awsManaged"].indexOf(this.policyFilter)?this.managedPolicyRisks:{PrivilegeEscalation:this.inlinePolicyRisks.PrivilegeEscalation+this.managedPolicyRisks.PrivilegeEscalation,DataExfiltration:this.inlinePolicyRisks.DataExfiltration+this.managedPolicyRisks.DataExfiltration,ResourceExposure:this.inlinePolicyRisks.ResourceExposure+this.managedPolicyRisks.ResourceExposure,InfrastructureModification:this.inlinePolicyRisks.InfrastructureModification+this.managedPolicyRisks.InfrastructureModification}}}},v=y,b=Object(g["a"])(v,l,c,!1,null,"5f2bc3cc",null),_=b.exports,P=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",e._l(e.getManagedPolicyIdsInUse,(function(i){return t("div",{key:i},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-5"},[t("div",{staticClass:"card"},[t("h6",{staticClass:"card-header",attrs:{id:"managed-policy."+i+".card"}},[e._v(" Name: "+e._s(e.managedPolicy(i)["PolicyName"])+" "),t("br"),t("br"),e._v(" PolicyId: "+e._s(i)+" "),t("br"),t("br"),e._v(" Attached to Principals: "),t("ul",[e.principalTypeLeveragingManagedPolicy(i,"Role").length>0?t("li",[e._v(" Roles: "),t("ul",e._l(e.principalTypeLeveragingManagedPolicy(i,"Role"),(function(i){return t("li",{key:i},[e._v(" "+e._s(i)+" ")])})),0)]):e._e(),e.principalTypeLeveragingManagedPolicy(i,"User").length>0?t("li",[e._v(" Users: "),t("ul",e._l(e.principalTypeLeveragingManagedPolicy(i,"User"),(function(i){return t("li",{key:i},[e._v(" "+e._s(i)+" ")])})),0)]):e._e(),e.principalTypeLeveragingManagedPolicy(i,"Group").length>0?t("li",[e._v(" Groups: "),t("ul",e._l(e.principalTypeLeveragingManagedPolicy(i,"Group"),(function(i){return t("li",{key:i},[e._v(" "+e._s(i)+" ")])})),0)]):e._e()])]),t("div",{staticClass:"card-body"},[t("p",{staticClass:"card-text"},[e._v(" Services: "+e._s(e.servicesAffectedByManagedPolicy(i).length)+" "),t("br"),e._v(" Infrastructure Modification Actions: "+e._s(e.managedPolicyFindings(i,"InfrastructureModification").length)+" "),t("br")])]),e._v(" "),t("div",{staticClass:"card-footer"},[e.managedPolicyFindings(i,"PrivilegeEscalation").length>0?[t("div",{staticClass:"alert alert-danger popovers",attrs:{"data-html":"true","data-placement":"top","data-toggle":"popover",role:"alert",title:"Privilege Escalation","data-content":e.getRiskDefinition("PrivilegeEscalation")}},[e._v("Privilege Escalation ")])]:e._e(),e.managedPolicyFindings(i,"DataExfiltration").length>0?[t("div",{staticClass:"alert alert-warning popovers",attrs:{"data-html":"true","data-placement":"top","data-toggle":"popover",role:"alert",title:"Data Exfiltration","data-content":e.getRiskDefinition("DataExfiltration")}},[e._v("Data Exfiltration ")])]:e._e(),e.managedPolicyFindings(i,"ResourceExposure").length>0?[t("div",{staticClass:"alert alert-danger popovers",attrs:{"data-html":"true","data-placement":"top","data-toggle":"popover",role:"alert",title:"Resource Exposure","data-content":e.getRiskDefinition("ResourceExposure")}},[e._v("Resource Exposure ")])]:e._e(),e.managedPolicyAssumableByComputeService(i).length>0?[t("div",{staticClass:"alert alert-info popovers",attrs:{"data-html":"true","data-placement":"top","data-toggle":"popover",role:"alert",title:"Policy leveraged by Compute Service Role","data-content":e.getRiskDefinition("AssumableByComputeService")}},[e._v("Policy leveraged by Compute Service Role ")])]:e._e()],2)]),t("br"),t("br")]),t("div",{staticClass:"col-md-7"},[t("div",{attrs:{id:"managed-policy-"+i+"-card-details"}},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#managed-policy-"+i+"-card-details",href:"#managed-policy-"+i+"-policydocument"}},[e._v("Policy Document")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"managed-policy-"+i+"-policydocument"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.managedPolicyDocument(i),void 0,"\t")))+"\n")])])])]),e.managedPolicyAssumableByComputeService(i).length>0?t("div",[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#managed-policy-"+i+"-card-details",href:"#managed-policy-"+i+"-assumable"}},[e._v("Compute Services that leverage this IAM Policy via AssumeRole")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"managed-policy-"+i+"-assumable"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.managedPolicyAssumableByComputeService(i),void 0,"\t")))+"\n")])])])])]):e._e(),e.managedPolicyFindings(i,"DataExfiltration").length>0?t("div",[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#managed-policy-"+i+"-card-details",href:"#managed-policy-"+i+"-data-exfiltration"}},[e._v("Data Exfiltration")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"managed-policy-"+i+"-data-exfiltration"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.managedPolicyFindings(i,"DataExfiltration"),void 0,"\t")))+"\n")])])])])]):e._e(),t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#managed-policy-"+i+"-card-details",href:"#managed-policy-"+i+"-infrastructure-modification-actions"}},[e._v("Infrastructure Modification Actions")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"managed-policy-"+i+"-infrastructure-modification-actions"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.managedPolicyFindings(i,"InfrastructureModification"),void 0,"\t")))+"\n")])])])]),e.managedPolicyFindings(i,"PrivilegeEscalation").length>0?t("div",[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#managed-policy-"+i+"-card-details",href:"#managed-policy-"+i+"-privilege-escalation"}},[e._v("Privilege Escalation")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"managed-policy-"+i+"-privilege-escalation"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.managedPolicyFindings(i,"PrivilegeEscalation"),void 0,"\t")))+"\n")])])])])]):e._e(),e.managedPolicyFindings(i,"ResourceExposure").length>0?t("div",[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#managed-policy-"+i+"-card-details",href:"#managed-policy-"+i+"-resource-exposure"}},[e._v("Resource Exposure")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"managed-policy-"+i+"-resource-exposure"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.managedPolicyFindings(i,"ResourceExposure"),void 0,"\t")))+"\n")])])])])]):e._e()])])])])])})),0)},w=[],k=t("8c16"),M=t("51d3"),A={name:"ManagedPolicies",props:{iam_data:{type:Object},riskDefinitions:{type:Array},managedBy:{type:String}},computed:{getManagedPolicyIdsInUse:function(){return k.getManagedPolicyIdsInUse(this.iam_data,this.managedBy)}},methods:{managedPolicyDocument:function(e){return k.getManagedPolicyDocument(this.iam_data,this.managedBy,e)},managedPolicy:function(e){return k.getManagedPolicy(this.iam_data,this.managedBy,e)},principalTypeLeveragingManagedPolicy:function(e,i){return k.getPrincipalTypeLeveragingManagedPolicy(this.iam_data,this.managedBy,e,i)},isManagedPolicyLeveraged:function(e){return k.isManagedPolicyLeveraged(this.iam_data,this.managedBy,e)},managedPolicyFindings:function(e,i){return k.getManagedPolicyFindings(this.iam_data,this.managedBy,e,i)},servicesAffectedByManagedPolicy:function(e){return k.getServicesAffectedByManagedPolicy(this.iam_data,this.managedBy,e)},managedPolicyAssumableByComputeService:function(e){return k.managedPolicyAssumableByComputeService(this.iam_data,this.managedBy,e)},getRiskDefinition:function(e){return M.getRiskDefinition(e)}}},S=A,C=Object(g["a"])(S,P,w,!1,null,"119e7f1c",null),x=C.exports,j=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",e._l(e.inlinePolicyIds,(function(i){return t("div",{key:i},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-5"},[t("div",{staticClass:"card"},[t("h6",{staticClass:"card-header",attrs:{id:"inline-policy."+i+".card"}},[e._v(" Name: "+e._s(e.inlinePolicy(i).PolicyName)+" "),t("br"),t("br"),e._v(" Attached to Principals: "),t("ul",[e.principalTypeLeveragingInlinePolicy(i,"Role").length>0?t("li",[e._v(" Roles: "),t("ul",e._l(e.principalTypeLeveragingInlinePolicy(i,"Role"),(function(i){return t("li",{key:i},[e._v(" "+e._s(i)+" ")])})),0)]):e._e(),e.principalTypeLeveragingInlinePolicy(i,"User").length>0?t("li",[e._v(" Users: "),t("ul",e._l(e.principalTypeLeveragingInlinePolicy(i,"User"),(function(i){return t("li",{key:i},[e._v(" "+e._s(i)+" ")])})),0)]):e._e(),e.principalTypeLeveragingInlinePolicy(i,"Group").length>0?t("li",[e._v(" Groups: "),t("ul",e._l(e.principalTypeLeveragingInlinePolicy(i,"Group"),(function(i){return t("li",{key:i},[e._v(" "+e._s(i)+" ")])})),0)]):e._e()])]),t("div",{staticClass:"card-body"},[t("p",{staticClass:"card-text"},[e._v(" Services: "+e._s(e.servicesAffectedByInlinePolicy(i).length)+" "),t("br"),t("br"),e._v(" Infrastructure Modification Actions: "+e._s(e.inlinePolicyFindings(i,"InfrastructureModification").length)+" "),t("br")])]),e._v(" "),t("div",{staticClass:"card-footer"},[e.inlinePolicyFindings(i,"PrivilegeEscalation").length>0?[t("div",{staticClass:"alert alert-danger popovers",attrs:{"data-html":"true","data-placement":"top","data-toggle":"popover",role:"alert",title:"Privilege Escalation","data-content":e.getRiskDefinition("PrivilegeEscalation")}},[e._v("Privilege Escalation ")])]:e._e(),e.inlinePolicyFindings(i,"DataExfiltration").length>0?[t("div",{staticClass:"alert alert-warning popovers",attrs:{"data-html":"true","data-placement":"top","data-toggle":"popover",role:"alert",title:"Data Exfiltration","data-content":e.getRiskDefinition("DataExfiltration")}},[e._v("Data Exfiltration ")])]:e._e(),e.inlinePolicyFindings(i,"ResourceExposure").length>0?[t("div",{staticClass:"alert alert-danger popovers",attrs:{"data-html":"true","data-placement":"top","data-toggle":"popover",role:"alert",title:"Resource Exposure","data-content":e.getRiskDefinition("ResourceExposure")}},[e._v("Resource Exposure ")])]:e._e(),e.inlinePolicyAssumableByComputeService(i).length>0?[t("div",{staticClass:"alert alert-info popovers",attrs:{"data-html":"true","data-placement":"top","data-toggle":"popover",role:"alert",title:"Policy leveraged by Compute Service Role","data-content":e.getRiskDefinition("AssumableByComputeService")}},[e._v("Policy leveraged by Compute Service Role ")])]:e._e()],2)]),t("br"),t("br")]),t("div",{staticClass:"col-md-7"},[t("div",{attrs:{id:"inline-policy-"+i+"-card-details"}},[t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#inline-policy-"+i+"-card-details",href:"#inline-policy-"+i+"-policydocument"}},[e._v("Policy Document")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"inline-policy-"+i+"-policydocument"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.inlinePolicyDocument(i),void 0,"\t")))+"\n")])])])]),e.inlinePolicyAssumableByComputeService(i).length>0?[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#inline-policy-"+i+"-card-details",href:"#inline-policy-"+i+"-assumable"}},[e._v("Compute Services that leverage this IAM Policy via AssumeRole")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"inline-policy-"+i+"-assumable"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.inlinePolicyAssumableByComputeService(i),void 0,"\t")))+"\n")])])])])]:e._e(),e.inlinePolicyFindings(i,"DataExfiltration").length>0?[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#inline-policy-"+i+"-card-details",href:"#inline-policy-"+i+"-data-exfiltration"}},[e._v("Data Exfiltration")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"inline-policy-"+i+"-data-exfiltration"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.inlinePolicyFindings(i,"DataExfiltration"),void 0,"\t")))+"\n")])])])])]:e._e(),t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#inline-policy-"+i+"-card-details",href:"#inline-policy-"+i+"-infrastructure-modification-actions"}},[e._v("Infrastructure Modification Actions")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"inline-policy-"+i+"-infrastructure-modification-actions"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.inlinePolicyFindings(i,"InfrastructureModification"),void 0,"\t")))+"\n")])])])]),e.inlinePolicyFindings(i,"PrivilegeEscalation").length>0?t("div",[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#inline-policy-"+i+"-card-details",href:"#inline-policy-"+i+"-privilege-escalation"}},[e._v("Privilege Escalation")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"inline-policy-"+i+"-privilege-escalation"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.inlinePolicyFindings(i,"PrivilegeEscalation"),void 0,"\t")))+"\n")])])])])]):e._e(),e.inlinePolicyFindings(i,"ResourceExposure").length>0?t("div",[t("div",{staticClass:"card-header"},[t("a",{staticClass:"card-link",attrs:{"data-toggle":"collapse","data-parent":"#inline-policy-"+i+"-card-details",href:"#inline-policy-"+i+"-resource-exposure"}},[e._v("Resource Exposure")])]),t("div",{staticClass:"panel-collapse collapse",attrs:{id:"inline-policy-"+i+"-resource-exposure"}},[t("div",{staticClass:"card-body"},[t("pre",[t("code",[e._v("\n"+e._s(JSON.parse(JSON.stringify(e.inlinePolicyFindings(i,"ResourceExposure"),void 0,"\t")))+"\n")])])])])]):e._e()],2)])])])])})),0)},R=[],I=t("104f"),N=t.n(I),E=t("1ff4"),O=t("51d3"),T=t("d4cd")({html:!0,linkify:!0,typographer:!0}),D=T.render(N.a),W={name:"InlinePolicies",props:{iam_data:{type:Object},riskDefinitions:{type:Array}},computed:{inlinePolicyIds:function(){return E.getInlinePolicyIds(this.iam_data)},summary:function(){return D}},methods:{inlinePolicyDocument:function(e){return E.getInlinePolicyDocument(this.iam_data,e)},inlinePolicy:function(e){return E.getInlinePolicy(this.iam_data,e)},inlinePolicyFindings:function(e,i){return E.getInlinePolicyFindings(this.iam_data,e,i)},servicesAffectedByInlinePolicy:function(e){return E.getServicesAffectedByInlinePolicy(this.iam_data,e)},principalTypeLeveragingInlinePolicy:function(e,i){return E.getPrincipalTypeLeveragingInlinePolicy(this.iam_data,e,i)},inlinePolicyAssumableByComputeService:function(e){return E.inlinePolicyAssumableByComputeService(this.iam_data,e)},getRiskDefinition:function(e){return O.getRiskDefinition(e)}}},G=W,z=Object(g["a"])(G,j,R,!1,null,"d8d60832",null),L=z.exports,U=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("h2",[e._v("Principals")]),t("br"),e._v(" This page displays IAM Users, Groups, and Roles in the account, their associated policies, the risks associated with each principal, and various metadata that can be expanded per principal. "),t("br"),t("br"),t("h3",[e._v("Roles")]),t("div",{attrs:{id:"iam.roles"}},e._l(e.roleNames,(function(i){return t("div",{key:i},[t("br"),t("b-container",[t("b-row",{staticClass:"px-2"},[t("b-col",[t("h4",[e._v(e._s(i)+" "),t("br"),t("small",{staticClass:"text-muted"},[e._v(e._s(e.getPrincipalMetadata(i,"Role")["arn"]))])])]),t("b-col",[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".risk.collapse",expression:"'iam.roles' + '.' + getPrincipalMetadata(roleName, 'Role')['id'] + '.' + 'risk' + '.' + 'collapse'"}]},[e._v(" Show ")])],1)],1),t("br"),t("b-collapse",{attrs:{id:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".risk.collapse"}},[t("b-row",{staticClass:"px-2"},[t("b-col",{attrs:{lg:"4"}},[t("h5",[e._v("Risks")]),t("b-list-group",e._l(e.riskNames,(function(a){return t("div",{key:a},[[t("dd",{staticClass:"col-sm-12"},[t("dl",{staticClass:"row"},[t("b-list-group-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".risk."+a+".collapse",expression:"'iam.roles' + '.' + getPrincipalMetadata(roleName, 'Role')['id'] + '.' + 'risk' + '.' + riskName + '.' + 'collapse'"}],staticClass:"d-flex justify-content-between align-items-center",attrs:{action:!0}},[e._v(" "+e._s(e.addSpacesInPascalCaseString(a))+" "),t("b-button",{attrs:{variant:e.getRiskLevel(a),size:"sm"}},[e._v(" "+e._s(e.getRiskAssociatedWithPrincipal(i,"Role",a).length)+" ")])],1)],1)]),t("b-collapse",{attrs:{id:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".risk."+a+".collapse"}},[t("dd",{staticClass:"col-sm-12"},[t("br"),t("pre",[t("code",[e._v(e._s(e.getRiskAssociatedWithPrincipal(i,"Role",a)))])]),t("br")])])]],2)})),0)],1),t("b-col",[t("h5",[e._v("Metadata")]),t("dl",{staticClass:"row"},[t("dt",{staticClass:"col-sm-3"},[e._v("Created")]),t("dd",{staticClass:"col-sm-9"},[e._v(e._s(e.getPrincipalMetadata(i,"Role")["create_date"])+" ")]),t("dt",{staticClass:"col-sm-3"},[e._v("ARN")]),t("dd",{staticClass:"col-sm-9 text-monospace"},[e._v(e._s(e.getPrincipalMetadata(i,"Role")["arn"])+" ")]),t("dt",{staticClass:"col-sm-3"},[e._v("Inline Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".inline-policies.collapse",expression:"'iam.roles' + '.' + getPrincipalMetadata(roleName, 'Role')['id'] + '.' + 'inline-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"Role","Inline").length)+" ")]),t("b-collapse",{attrs:{id:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".inline-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"Role","Inline")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("AWS-Managed Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".aws-managed-policies.collapse",expression:"'iam.roles' + '.' + getPrincipalMetadata(roleName, 'Role')['id'] + '.' + 'aws-managed-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"Role","AWS").length)+" ")]),t("b-collapse",{attrs:{id:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".aws-managed-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"Role","AWS")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("Customer-Managed Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".customer-managed-policies.collapse",expression:"'iam.roles' + '.' + getPrincipalMetadata(roleName, 'Role')['id'] + '.' + 'customer-managed-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"Role","Customer").length)+" ")]),t("b-collapse",{attrs:{id:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".customer-managed-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"Role","Customer")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("Role Trust Policy")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".role-trust-policy.collapse",expression:"'iam.roles' + '.' + getPrincipalMetadata(roleName, 'Role')['id'] + '.' + 'role-trust-policy' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" Details ")]),t("b-collapse",{attrs:{id:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".role-trust-policy.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(JSON.parse(JSON.stringify(e.getRoleTrustPolicy(i)))))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("Instance Profiles")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".instance-profiles.collapse",expression:"'iam.roles' + '.' + getPrincipalMetadata(roleName, 'Role')['id'] + '.' + 'instance-profiles' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalMetadata(i,"Role")["instance_profiles"].length)+" ")]),t("b-collapse",{attrs:{id:"iam.roles."+e.getPrincipalMetadata(i,"Role")["id"]+".instance-profiles.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(JSON.parse(JSON.stringify(e.getPrincipalMetadata(i,"Role")["instance_profiles"]))))])])])],1)])])],1),t("br"),t("br")],1)],1)],1)})),0),t("br"),t("h3",[e._v("Groups")]),t("div",{attrs:{id:"iam.groups"}},e._l(e.groupNames,(function(i){return t("div",{key:i},[t("br"),t("b-container",[t("b-row",{staticClass:"px-2"},[t("b-col",[t("h4",[e._v(e._s(i)+" "),t("br"),t("small",{staticClass:"text-muted"},[e._v(e._s(e.getPrincipalMetadata(i,"Group")["arn"]))])])]),t("b-col",[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".risk.collapse",expression:"'iam.groups' + '.' + getPrincipalMetadata(groupName, 'Group')['id'] + '.' + 'risk' + '.' + 'collapse'"}]},[e._v(" Show ")])],1)],1),t("br"),t("b-collapse",{attrs:{id:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".risk.collapse"}},[t("b-row",{staticClass:"px-2"},[t("b-col",{attrs:{lg:"4"}},[t("h5",[e._v("Risks")]),t("b-list-group",e._l(e.riskNames,(function(a){return t("div",{key:a},[[t("dd",{staticClass:"col-sm-12"},[t("dl",{staticClass:"row"},[t("b-list-group-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".risk."+a+".collapse",expression:"'iam.groups' + '.' + getPrincipalMetadata(groupName, 'Group')['id'] + '.' + 'risk' + '.' + riskName + '.' + 'collapse'"}],staticClass:"d-flex justify-content-between align-items-center",attrs:{action:!0}},[e._v(" "+e._s(e.addSpacesInPascalCaseString(a))+" "),t("b-button",{attrs:{variant:e.getRiskLevel(a),size:"sm"}},[e._v(" "+e._s(e.getRiskAssociatedWithPrincipal(i,"Group",a).length)+" ")])],1)],1)]),t("b-collapse",{attrs:{id:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".risk."+a+".collapse"}},[t("dd",{staticClass:"col-sm-12"},[t("br"),t("pre",[t("code",[e._v(e._s(e.getRiskAssociatedWithPrincipal(i,"Group",a)))])]),t("br")])])]],2)})),0)],1),t("b-col",[t("h5",[e._v("Metadata")]),t("dl",{staticClass:"row"},[t("dt",{staticClass:"col-sm-3"},[e._v("Created")]),t("dd",{staticClass:"col-sm-9"},[e._v(e._s(e.getPrincipalMetadata(i,"Group")["create_date"])+" ")]),t("dt",{staticClass:"col-sm-3"},[e._v("ARN")]),t("dd",{staticClass:"col-sm-9 text-monospace"},[e._v(e._s(e.getPrincipalMetadata(i,"Group")["arn"])+" ")]),t("dt",{staticClass:"col-sm-3"},[e._v("Inline Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".inline-policies.collapse",expression:"'iam.groups' + '.' + getPrincipalMetadata(groupName, 'Group')['id'] + '.' + 'inline-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"Group","Inline").length)+" ")]),t("b-collapse",{attrs:{id:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".inline-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"Group","Inline")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("AWS-Managed Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".aws-managed-policies.collapse",expression:"'iam.groups' + '.' + getPrincipalMetadata(groupName, 'Group')['id'] + '.' + 'aws-managed-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"Group","AWS").length)+" ")]),t("b-collapse",{attrs:{id:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".aws-managed-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"Group","AWS")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("Customer-Managed Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".customer-managed-policies.collapse",expression:"'iam.groups' + '.' + getPrincipalMetadata(groupName, 'Group')['id'] + '.' + 'customer-managed-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"Group","Customer").length)+" ")]),t("b-collapse",{attrs:{id:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".customer-managed-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"Group","Customer")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("Group Members")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".group-members.collapse",expression:"'iam.groups' + '.' + getPrincipalMetadata(groupName, 'Group')['id'] + '.' + 'group-members' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" Details ")]),t("b-collapse",{attrs:{id:"iam.groups."+e.getPrincipalMetadata(i,"Group")["id"]+".group-members.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(JSON.parse(JSON.stringify(e.getGroupMembers(i)))))])])])],1)])])],1),t("br"),t("br")],1)],1)],1)})),0),t("br"),t("h3",[e._v("Users")]),e._l(e.userNames,(function(i){return t("div",{key:i},[t("br"),t("b-container",[t("b-row",{staticClass:"px-2"},[t("b-col",[t("h4",[e._v(e._s(i)+" "),t("br"),t("small",{staticClass:"text-muted"},[e._v(e._s(e.getPrincipalMetadata(i,"User")["arn"]))])])]),t("b-col",[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".risk.collapse",expression:"'iam.users' + '.' + getPrincipalMetadata(userName, 'User')['id'] + '.' + 'risk' + '.' + 'collapse'"}]},[e._v(" Show ")])],1)],1),t("br"),t("b-collapse",{attrs:{id:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".risk.collapse"}},[t("b-row",{staticClass:"px-2"},[t("b-col",{attrs:{lg:"4"}},[t("h5",[e._v("Risks")]),t("b-list-group",e._l(e.riskNames,(function(a){return t("div",{key:a},[[t("dd",{staticClass:"col-sm-12"},[t("dl",{staticClass:"row"},[t("b-list-group-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".risk."+a+".collapse",expression:"'iam.users' + '.' + getPrincipalMetadata(userName, 'User')['id'] + '.' + 'risk' + '.' + riskName + '.' + 'collapse'"}],staticClass:"d-flex justify-content-between align-items-center",attrs:{action:!0}},[e._v(" "+e._s(e.addSpacesInPascalCaseString(a))+" "),t("b-button",{attrs:{variant:e.getRiskLevel(a),size:"sm"}},[e._v(" "+e._s(e.getRiskAssociatedWithPrincipal(i,"User",a).length)+" ")])],1)],1)]),t("b-collapse",{attrs:{id:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".risk."+a+".collapse"}},[t("dd",{staticClass:"col-sm-12"},[t("br"),t("pre",[t("code",[e._v(e._s(e.getRiskAssociatedWithPrincipal(i,"User",a)))])]),t("br")])])]],2)})),0)],1),t("b-col",[t("h5",[e._v("Metadata")]),t("dl",{staticClass:"row"},[t("dt",{staticClass:"col-sm-3"},[e._v("Created")]),t("dd",{staticClass:"col-sm-9"},[e._v(e._s(e.getPrincipalMetadata(i,"User")["create_date"])+" ")]),t("dt",{staticClass:"col-sm-3"},[e._v("ARN")]),t("dd",{staticClass:"col-sm-9 text-monospace"},[e._v(e._s(e.getPrincipalMetadata(i,"User")["arn"])+" ")]),t("dt",{staticClass:"col-sm-3"},[e._v("Inline Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".inline-policies.collapse",expression:"'iam.users' + '.' + getPrincipalMetadata(userName, 'User')['id'] + '.' + 'inline-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"User","Inline").length)+" ")]),t("b-collapse",{attrs:{id:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".inline-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"User","Inline")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("AWS-Managed Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".aws-managed-policies.collapse",expression:"'iam.users' + '.' + getPrincipalMetadata(userName, 'User')['id'] + '.' + 'aws-managed-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"User","AWS").length)+" ")]),t("b-collapse",{attrs:{id:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".aws-managed-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"User","AWS")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("Customer-Managed Policies")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".customer-managed-policies.collapse",expression:"'iam.users' + '.' + getPrincipalMetadata(userName, 'User')['id'] + '.' + 'customer-managed-policies' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" "+e._s(e.getPrincipalPolicyNames(i,"User","Customer").length)+" ")]),t("b-collapse",{attrs:{id:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".customer-managed-policies.collapse"}},[t("br"),t("pre",[t("code",[e._v(e._s(e.getPrincipalPolicyNames(i,"User","Customer")))])])])],1),t("dt",{staticClass:"col-sm-3"},[e._v("Group Memberships")]),t("dd",{staticClass:"col-sm-9"},[t("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".group-membership.collapse",expression:"'iam.users' + '.' + getPrincipalMetadata(userName, 'User')['id'] + '.' + 'group-membership' + '.' + 'collapse'"}],attrs:{size:"sm"}},[e._v(" Details ")]),t("b-collapse",{attrs:{id:"iam.users."+e.getPrincipalMetadata(i,"User")["id"]+".group-membership.collapse"}},[t("br"),t("p",[e._v("Group Memberships")]),t("pre",[t("code",[e._v(e._s(JSON.parse(JSON.stringify(e.getGroupMembers(i)))))])])])],1)])])],1),t("br"),t("br")],1)],1)],1)})),t("div",{attrs:{id:"iam.users"}})],2)},F=[],B=t("b4fa"),q=t("bb52"),J=t("43be"),H=t("e56f"),V=t("51d3"),$={name:"Principals",props:{iam_data:{type:Object}},computed:{roleNames:function(){return B.getPrincipalNames(this.iam_data,"Role")},userNames:function(){return B.getPrincipalNames(this.iam_data,"User")},groupNames:function(){return B.getPrincipalNames(this.iam_data,"Group")},riskNames:function(){return["DataExfiltration","ResourceExposure","PrivilegeEscalation","InfrastructureModification"]}},methods:{getPrincipalMetadata:function(e,i){return B.getPrincipalMetadata(this.iam_data,e,i)},getPrincipalPolicies:function(e,i,t){return B.getPrincipalPolicies(this.iam_data,e,i,t)},getRiskAssociatedWithPrincipal:function(e,i,t){return B.getRiskAssociatedWithPrincipal(this.iam_data,e,i,t)},getRoleTrustPolicy:function(e){return q.getTrustPolicyDocumentForRole(this.iam_data,e)},getRiskDefinition:function(e){return V.getRiskDefinition(e)},getGroupMembers:function(e){return J.getGroupMembers(this.iam_data,e)},addSpacesInPascalCaseString:function(e){return H.addSpacesInPascalCaseString(e)},getPrincipalPolicyNames:function(e,i,t){return B.getPrincipalPolicyNames(this.iam_data,e,i,t)},getRiskLevel:function(e){return"DataExfiltration"===e?"warning":"PrivilegeEscalation"===e?"danger":"ResourceExposure"===e?"warning":"InfrastructureModification"===e?"info":void 0}}},K=$,Y=Object(g["a"])(K,U,F,!1,null,"def5a23e",null),Z=Y.exports,Q=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticStyle:{"text-align":"justify"}},[t("h3",{attrs:{id:"triage-guidance"}},[e._v("Triaging")]),t("p",[t("span",{domProps:{innerHTML:e._s(e.triageGuidance)}})]),t("br"),t("br"),t("h3",{attrs:{id:"remediation-guidance"}},[e._v("Remediation")]),t("p",[t("span",{domProps:{innerHTML:e._s(e.remediationGuidance)}})]),t("br"),t("br"),t("h3",{attrs:{id:"validation-guidance"}},[e._v("Validation")]),t("p",[t("span",{domProps:{innerHTML:e._s(e.validationText)}})]),t("br"),t("br")])},X=[],ee=t("1ec7"),ie=t.n(ee),te=t("b54a"),ae=t.n(te),se=t("f0d7"),oe=t.n(se),ne=t("e6d8"),re=t.n(ne),le=t("d4cd")({html:!0,linkify:!0,typographer:!0}),ce=le.render(ie.a),de=le.render(ae.a),pe=le.render(oe.a),ue=le.render(re.a),ge={name:"Guidance",computed:{overview:function(){return ce},triageGuidance:function(){return de},remediationGuidance:function(){return pe},validationText:function(){return ue}}},me=ge,he=Object(g["a"])(me,Q,X,!1,null,"d117cb44",null),fe=he.exports,ye=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticStyle:{"text-align":"justify"}},[t("h3",{attrs:{id:"overview"}},[e._v("Glossary")]),t("p",[t("span",{domProps:{innerHTML:e._s(e.glossary)}})]),t("br"),t("br")])},ve=[],be=t("557f"),_e=t.n(be),Pe=t("d4cd")({html:!0,linkify:!0,typographer:!0}),we=Pe.render(_e.a),ke={name:"Glossary",computed:{glossary:function(){return we}}},Me=ke,Ae=Object(g["a"])(Me,ye,ve,!1,null,"3ac60da4",null),Se=Ae.exports,Ce=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("b-container",[t("b-row",[t("b-col"),t("b-col"),t("b-col",[t("b-form-group",{staticClass:"mb-0",attrs:{label:"Per page","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[t("b-form-select",{attrs:{id:"perPageSelect",size:"sm",options:e.pageOptions},model:{value:e.perPage,callback:function(i){e.perPage=i},expression:"perPage"}})],1)],1)],1),t("b-table",{attrs:{items:e.policyNameMapping,fields:e.fields,"sort-by":e.sortBy,"sort-desc":e.sortDesc,"current-page":e.currentPage,"per-page":e.perPage,responsive:"sm",small:""},on:{"update:sortBy":function(i){e.sortBy=i},"update:sort-by":function(i){e.sortBy=i},"update:sortDesc":function(i){e.sortDesc=i},"update:sort-desc":function(i){e.sortDesc=i}},scopedSlots:e._u([{key:"cell(attached_to_principals)",fn:function(i){return[e._v(" "+e._s(i.item.attached_to_principals.join(", "))+" ")]}},{key:"cell(compute_role)",fn:function(i){return[e._v(" "+e._s(i.item.compute_role.join(", "))+" ")]}}])})],1),t("br"),t("hr"),t("br")],1)},xe=[],je={name:"PolicyTable",props:{policyNameMapping:{type:Array}},data:function(){return{sortBy:"policy_name",sortDesc:!1,fields:[{key:"policy_name",sortable:!0},{key:"attached_to_principals",sortable:!0},{key:"services",sortable:!0},{key:"infrastructure_modification",sortable:!0},{key:"privilege_escalation",sortable:!0},{key:"resource_exposure",sortable:!0},{key:"data_exfiltration",sortable:!0},{key:"compute_role",sortable:!0}],totalRows:1,currentPage:1,perPage:10,pageOptions:[5,10,15,20,50,100]}},methods:{}},Re=je,Ie=Object(g["a"])(Re,Ce,xe,!1,null,"5a6ad506",null),Ne=Ie.exports,Ee=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("b-container",{attrs:{id:"iam.task."+e.managedBy}},[t("b-row",[t("b-col"),t("b-col"),t("b-col",[t("b-form-group",{staticClass:"mb-0",attrs:{label:"Per page","label-cols-sm":"6","label-cols-md":"4","label-cols-lg":"3","label-align-sm":"right","label-size":"sm","label-for":"perPageSelect"}},[t("b-form-select",{attrs:{id:"perPageSelect",size:"sm",options:e.pageOptions},model:{value:e.perPage,callback:function(i){e.perPage=i},expression:"perPage"}})],1)],1)],1),t("b-table",{attrs:{items:e.items_mapping,fields:e.fields,small:"","sort-by":e.sortBy,"sort-desc":e.sortDesc,"current-page":e.currentPage,"per-page":e.perPage,responsive:"sm"},on:{"update:sortBy":function(i){e.sortBy=i},"update:sort-by":function(i){e.sortBy=i},"update:sortDesc":function(i){e.sortDesc=i},"update:sort-desc":function(i){e.sortDesc=i}},scopedSlots:e._u([{key:"cell(policy_document)",fn:function(i){return[t("b-button",{staticClass:"mr-1",attrs:{size:"sm"},on:{click:function(t){return e.info(i.item,i.index,t.target,"policy_document")}}},[e._v(" See Policy Document ")])]}},{key:"cell(infrastructure_modification)",fn:function(i){return[e._v(" "+e._s(i.item.infrastructure_modification.length)+" ")]}},{key:"cell(resource_exposure)",fn:function(i){return[e._v(" "+e._s(i.item.resource_exposure.length)+" ")]}},{key:"cell(data_exfiltration)",fn:function(i){return[e._v(" "+e._s(i.item.data_exfiltration.length)+" ")]}},{key:"cell(privilege_escalation)",fn:function(i){return[e._v(" "+e._s(i.item.privilege_escalation.length)+" ")]}},{key:"cell(services)",fn:function(i){return[e._v(" "+e._s(i.item.services.length)+" ")]}},{key:"cell(compute_role)",fn:function(i){return[e._v(" "+e._s(i.item.compute_role.join(", "))+" ")]}},{key:"cell(show_details)",fn:function(i){return[t("b-button",{staticClass:"mr-2",attrs:{size:"sm"},on:{click:i.toggleDetails}},[e._v(" "+e._s(i.detailsShowing?"Hide":"Show")+" Details ")])]}},{key:"row-details",fn:function(i){return[t("b-card",[t("b-row",{staticClass:"mb-2"},[t("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[t("b",[e._v("Risks")])]),t("b-col",[t("b-list-group",e._l(e.riskNames,(function(a){return t("div",{key:a},[[t("dd",{staticClass:"col-sm-12"},[t("dl",{staticClass:"row"},[t("b-list-group-item",{directives:[{name:"b-toggle",rawName:"v-b-toggle",value:"iam.tasks."+i.item.policy_id+".risk."+a+".collapse",expression:"'iam.tasks' + '.' + row.item.policy_id + '.' + 'risk' + '.' + riskName + '.' + 'collapse'"}],staticClass:"d-flex justify-content-between align-items-center",attrs:{action:!0}},[e._v(" "+e._s(e.addSpacesInPascalCaseString(a))+" "),t("b-button",{attrs:{variant:e.getRiskLevel(a),size:"sm"}},[e._v(" "+e._s(i.item[e.convertStringToSnakeCase(a)].length)+" ")])],1)],1)]),t("b-collapse",{attrs:{id:"iam.tasks."+i.item.policy_id+".risk."+a+".collapse"}},[t("dd",{staticClass:"col-sm-12"},[t("br"),t("pre",[t("code",[e._v(e._s(i.item[e.convertStringToSnakeCase(a)]))])]),t("br")])])]],2)})),0)],1)],1),t("b-button",{attrs:{size:"sm"},on:{click:i.toggleDetails}},[e._v("Hide Details")])],1)]}}])}),t("b-modal",{attrs:{id:e.infoModal.id,title:e.infoModal.title,"ok-only":""},on:{hide:e.resetInfoModal}},[t("pre",[e._v(e._s(e.infoModal.content))])])],1),t("br"),t("hr"),t("br")],1)},Oe=[],Te=t("8c16"),De=t("e56f"),We={name:"TaskTable",props:{items_mapping:{type:Array},managedBy:{type:String}},data:function(){return{sortBy:"services",sortDesc:!1,fields:[{key:"policy_name",sortable:!0},{key:"policy_document",sortable:!1},{key:"services",sortable:!0},{key:"privilege_escalation",sortable:!0},{key:"resource_exposure",sortable:!0},{key:"data_exfiltration",sortable:!0},{key:"infrastructure_modification",sortable:!0},{key:"compute_role",sortable:!0},{key:"show_details",sortable:!1}],totalRows:1,currentPage:1,perPage:20,pageOptions:[5,10,15,20,50,100],infoModal:{id:"info-modal",title:"",content:""}}},computed:{riskNames:function(){return["DataExfiltration","ResourceExposure","PrivilegeEscalation","InfrastructureModification"]}},methods:{info:function(e,i,t,a){this.infoModal.title="Column: ".concat(a),this.infoModal.content=JSON.stringify(e[a],null,2),this.$root.$emit("bv::show::modal",this.infoModal.id,t)},managedPolicyFindings:function(e,i){return Te.getManagedPolicyFindings(this.iam_data,this.managedBy,e,i)},resetInfoModal:function(){this.infoModal.title="",this.infoModal.content=""},addSpacesInPascalCaseString:function(e){return De.addSpacesInPascalCaseString(e)},convertStringToSnakeCase:function(e){return De.convertStringToSnakeCase(e)},getRiskLevel:function(e){return"DataExfiltration"===e?"warning":"PrivilegeEscalation"===e?"danger":"ResourceExposure"===e?"warning":"InfrastructureModification"===e?"info":void 0}}},Ge=We,ze=Object(g["a"])(Ge,Ee,Oe,!1,null,"6a53b870",null),Le=ze.exports,Ue=t("8c16"),Fe=t("1ff4"),Be=t("6adc");function qe(e){return Ue.getManagedPolicyNameMapping(iam_data,e)}function Je(){return Fe.getInlinePolicyNameMapping(iam_data)}function He(e){return Be.getTaskTableMapping(iam_data,e)}console.log("production"),console.log("Cloudsplaining");var Ve={name:"App",components:{Summary:_,ManagedPolicies:x,InlinePolicies:L,Principals:Z,Guidance:fe,Glossary:Se,PolicyTable:Ne,TaskTable:Le},data:function(){return{sharedState:iam_data,policyFilter:"none",activeSection:0}},computed:{iam_data:function(){return this.sharedState}},methods:{getManagedPolicyNameMapping:function(e){return qe(e)},getInlinePolicyNameMapping:function(){return Je()},getTaskTableMapping:function(e){return He(e)}}},$e=Ve,Ke=(t("034f"),Object(g["a"])($e,n,r,!1,null,null,null)),Ye=Ke.exports,Ze=t("5f5b"),Qe=t("b1e0");o["default"].use(Ze["a"]),o["default"].use(Qe["a"]),o["default"].config.productionTip=!1,new o["default"]({render:function(e){return e(Ye)}}).$mount("#app")},"6adc":function(e,i,t){t("99af");var a=t("6374"),s=t("8c16"),o=t("e56f");function n(e,i,t){var o,n=[],r=a(t);try{for(r.s();!(o=r.n()).done;){var l=o.value,c=s.isManagedPolicyLeveraged(e,i,l);if(0!==c){var d=s.getManagedPolicyName(e,i,l),p=s.getAllPrincipalsLeveragingManagedPolicy(e,i,l),u=s.getServicesAffectedByManagedPolicy(e,i,l),g=s.getManagedPolicyFindings(e,i,l,"InfrastructureModification"),m=s.getManagedPolicyFindings(e,i,l,"PrivilegeEscalation"),h=s.getManagedPolicyFindings(e,i,l,"ResourceExposure"),f=s.getManagedPolicyFindings(e,i,l,"DataExfiltration"),y=[],v=[];y=s.getPrincipalTypeLeveragingManagedPolicy(l,"Role"),v=s.managedPolicyAssumableByComputeService(e,i,l);var b=void 0;b=s.getPrincipalTypeLeveragingManagedPolicy(l,"Group");var _=[];_=s.getPrincipalTypeLeveragingManagedPolicy(l,"User");var P=s.getManagedPolicyDocument(e,i,l),w={policy_name:d,policy_id:l,policy_document:P,attached_to_principals:p,services:u,privilege_escalation:m,resource_exposure:h,data_exfiltration:f,infrastructure_modification:g,compute_role:v,roles_leveraging_policy:y,groups_leveraging_policy:b,users_leveraging_policy:_,show_details:0};n.push(w)}else console.log("".concat(l," has leveraged length of ").concat(c," "))}}catch(k){r.e(k)}finally{r.f()}return n}function r(e,i){var t,r,l=s.getManagedPolicyIdsInUse(e,i),c=[],d=a(l);try{for(d.s();!(r=d.n()).done;)if(t=r.value,"AWS"===i){var p=Object.assign(e["aws_managed_policies"][t]["PolicyName"]);c.push({policy_name:p,policy_id:t})}else if("Customer"===i){var u=Object.assign(e["customer_managed_policies"][t]["PolicyName"]);c.push({policy_name:u,policy_id:t})}}catch(g){d.e(g)}finally{d.f()}return c.sort(o.compareValues("policy_name","asc")),n(e,i,l)}i.getTaskTableManagedPolicyItems=n,i.getTaskTableMapping=r},"8c16":function(e,i,t){"use strict";t("99af"),t("a630"),t("fb6a"),t("b64b"),t("d3b7"),t("ac1f"),t("6062"),t("3ca3"),t("1276"),t("ddb0");var a=t("6374"),s=t("bb52"),o=t("e56f");function n(e,i){var t=[];return"AWS"===i?t=Object.keys(e["aws_managed_policies"]):"Customer"===i&&(t=Object.keys(e["customer_managed_policies"])),t}function r(e,i){var t=[],a=[];"AWS"===i?a=Array.from(Object.keys(e["aws_managed_policies"])):"Customer"===i&&(a=Array.from(Object.keys(e["customer_managed_policies"])));for(var s=0;s<a.length;s++){var o=l(e,i,a[s]);o>0&&(0===p(e,i,a[s],"InfrastructureModification").length?console.log("Policy ID ".concat(a[s]," does not have any findings; excluding from report findings")):t.push(a[s].slice()))}return Array.from(t)}function l(e,i,t){var a=m(e,i,t,"Group").length,s=m(e,i,t,"User").length,o=m(e,i,t,"Role").length;return a+s+o}function c(e,i,t){return"AWS"===i?Object.assign(e["aws_managed_policies"][t]):"Customer"===i?Object.assign(e["customer_managed_policies"][t]):void 0}function d(e,i,t){return"AWS"===i?Object.assign(e["aws_managed_policies"][t]["PolicyVersionList"][0]["Document"]):"Customer"===i?Object.assign(e["customer_managed_policies"][t]["PolicyVersionList"][0]["Document"]):void 0}function p(e,i,t,a){var s=[];return"AWS"===i?s=Array.from(e["aws_managed_policies"][t][a]):"Customer"===i&&(s=Array.from(e["customer_managed_policies"][t][a])),s.sort(),s}function u(e,i,t){return"AWS"===i?e["aws_managed_policies"][t]["PolicyName"].slice():"Customer"===i?e["customer_managed_policies"][t]["PolicyName"].slice():void 0}function g(e,i,t){var s,o=[],n=[];"AWS"===i?n=Array.from(e["aws_managed_policies"][t]["InfrastructureModification"]):"Customer"===i&&(n=Array.from(e["customer_managed_policies"][t]["InfrastructureModification"]));var r,l=a(n);try{for(l.s();!(r=l.n()).done;){s=r.value;var c=s.split(":")[0];c in o||o.push(c)}}catch(d){l.e(d)}finally{l.f()}return Array.from(new Set(o)).sort()}function m(e,i,t,a){return"Role"===a?h(e,i,t):"Group"===a?y(e,i,t):"User"===a?f(e,i,t):void 0}function h(e,i,t){var a;a=Array.from(Object.keys(e["roles"]));for(var s=[],o=0;o<a.length;o++){var n=a[o],r=[];"AWS"===i?r=Object.assign(e["roles"][n]["aws_managed_policies"]):"Customer"===i&&(r=Object.assign(e["roles"][n]["customer_managed_policies"])),Object.prototype.hasOwnProperty.call(r,t)&&s.push(n)}return s}function f(e,i,t){var a;a=Array.from(Object.keys(e["users"]));for(var s=[],o=0;o<a.length;o++){var n=a[o],r=[];"AWS"===i?r=Object.assign(e["users"][n]["aws_managed_policies"]):"Customer"===i&&(r=Object.assign(e["users"][n]["customer_managed_policies"])),Object.prototype.hasOwnProperty.call(r,t)&&s.push(n)}return s}function y(e,i,t){var a;a=Object.keys(e["groups"]);for(var s=[],o=0;o<a.length;o++){var n=a[o],r=[];"AWS"===i?r=Object.assign(e["groups"][n]["aws_managed_policies"]):"Customer"===i&&(r=Object.assign(e["groups"][n]["customer_managed_policies"])),Object.prototype.hasOwnProperty.call(r,t)&&s.push(n)}return s}function v(e,i,t){var a,s,o;return a=f(e,i,t),s=y(e,i,t),o=h(e,i,t),a.concat(s,o)}function b(e,i,t){var a=h(e,i,t);if(!a.length>0)return[];for(var o=[],n=0;n<a.length;n++){var r=s.getTrustPolicyDocumentForRole(e,a[n]),l=s.trustPolicyAssumableByComputeService(r);if(l.length>0)for(var c=0;c<l.length;c++)l[c]in o||o.push(l[c])}return o}function _(e,i,t){var s,o=[],n=a(t);try{for(n.s();!(s=n.n()).done;){var r=s.value,l=u(e,i,r),c=v(e,i,r),d=g(e,i,r).length,m=p(e,i,r,"InfrastructureModification").length,h=p(e,i,r,"PrivilegeEscalation").length,f=p(e,i,r,"ResourceExposure").length,y=p(e,i,r,"DataExfiltration").length,_=b(e,i,r),P={policy_name:l,attached_to_principals:c,services:d,privilege_escalation:h,resource_exposure:f,data_exfiltration:y,infrastructure_modification:m,compute_role:_};o.push(P)}}catch(w){n.e(w)}finally{n.f()}return o}function P(e,i){var t,s,n=r(e,i),l=[],c=a(n);try{for(c.s();!(s=c.n()).done;)if(t=s.value,"AWS"===i){var d=e["aws_managed_policies"][t]["PolicyName"];l.push({policy_name:d,policy_id:t})}else if("Customer"===i){var p=e["customer_managed_policies"][t]["PolicyName"];l.push({policy_name:p,policy_id:t})}}catch(u){c.e(u)}finally{c.f()}return l.sort(o.compareValues("policy_name","asc")),_(e,i,n)}i.getManagedPolicyIds=n,i.getManagedPolicyIdsInUse=r,i.getManagedPolicyFindings=p,i.getManagedPolicy=c,i.getManagedPolicyDocument=d,i.getRolesLeveragingManagedPolicy=h,i.getServicesAffectedByManagedPolicy=g,i.getManagedPolicyName=u,i.getUsersLeveragingManagedPolicy=f,i.getGroupsLeveragingManagedPolicy=y,i.isManagedPolicyLeveraged=l,i.getPrincipalTypeLeveragingManagedPolicy=m,i.managedPolicyAssumableByComputeService=b,i.getAllPrincipalsLeveragingManagedPolicy=v,i.getManagedPolicyItems=_,i.getManagedPolicyNameMapping=P},b4fa:function(e,i,t){"use strict";t("a630"),t("b64b"),t("3ca3");var a=t("6374"),s=t("1ff4"),o=t("8c16"),n=t("e56f");function r(e,i,t){return"Role"===t?e["roles"][i]:"Group"===t?e["groups"][i]:"User"===t?e["users"][i]:void 0}function l(e,i){var t;return"Role"===i?(t=Object.keys(e["roles"]),t.sort()):"Group"===i?(t=Object.keys(e["groups"]),t.sort(),t):"User"===i?(t=Object.keys(e["users"]),t.sort(),t):void 0}function c(e,i,t,a){var s,o;"Role"===t?s="roles":"Group"===t?s="groups":"User"===t&&(s="users"),"Inline"===a?o="inline_policies":"Customer"===a?o="customer_managed_policies":"AWS"===a&&(o="aws_managed_policies");var n=e[s][i][o],r=Array.from(Object.keys(n));return r.sort(),r}function d(e,i,t,a){var n,r=[],l=c(e,i,t,a);if("Inline"===a)for(n in l)r.push(s.getInlinePolicy(e,l[n])["PolicyName"]);else if("AWS"===a)for(n in l)r.push(o.getManagedPolicyName(e,"AWS",l[n]));else if("Customer"===a)for(n in l)r.push(o.getManagedPolicyName(e,"Customer",l[n]));return r.sort(),r}function p(e,i,t,r){var l=c(e,i,t,"Inline"),d=c(e,i,t,"Customer"),p=c(e,i,t,"AWS"),u=[];if(l.length>0){var g,m,h=a(l);try{for(h.s();!(m=h.n()).done;){g=m.value;var f,y=s.getInlinePolicyFindings(e,g,r),v=void 0,b=a(y);try{for(b.s();!(f=b.n()).done;)v=f.value,v in u||u.push(v)}catch(O){b.e(O)}finally{b.f()}}}catch(O){h.e(O)}finally{h.f()}}if(d.length>0){var _,P,w=a(d);try{for(w.s();!(P=w.n()).done;){_=P.value;var k,M=o.getManagedPolicyFindings(e,"Customer",_,r),A=void 0,S=a(M);try{for(S.s();!(k=S.n()).done;)A=k.value,A in u||u.push(A)}catch(O){S.e(O)}finally{S.f()}}}catch(O){w.e(O)}finally{w.f()}}if(p.length>0){var C,x,j=a(p);try{for(j.s();!(x=j.n()).done;){C=x.value;var R,I=o.getManagedPolicyFindings(e,"AWS",C,r),N=void 0,E=a(I);try{for(E.s();!(R=E.n()).done;)N=R.value,N in u||u.push(N)}catch(O){E.e(O)}finally{E.f()}}}catch(O){j.e(O)}finally{j.f()}}return u.length>0?(u.sort(),u=n.removeDuplicatesFromArray(u),u):[]}i.getPrincipalMetadata=r,i.getPrincipalNames=l,i.getPrincipalPolicies=c,i.getRiskAssociatedWithPrincipal=p,i.getPrincipalPolicyNames=d},b54a:function(e,i){var t='<h5 id="understanding-context">Understanding Context</h5> <p>It&#39;s essential to understand the context behind the findings that the report generates. Understanding the context behind the findings aids the assessor in triaging the results accurately.</p> <p>This report generates findings on Policies that do not leverage resource constraints and identifies some attributes to help prioritize which ones to address - such as Privilege Escalation, Resource Exposure, and Data Exfiltration. These results help you to identify your IAM threat landscape and reduce blast radius. In the event of credential compromise, you can prevent an attacker from exploiting the risks mentioned above, in addition to preventing mass deletion, destruction, or modification of existing infrastructure.</p> <p>However, this tool does not attempt to understand the context behind everything in your AWS account. It&#39;s possible to understand the context behind some of these things programmatically - whether the policy is applied to an instance profile, whether the policy is attached, whether inline IAM policies are in use, and whether or not AWS Managed Policies are in use. <strong>Only you know the context behind the design of your AWS infrastructure and the IAM strategy</strong>.</p> <p>For example, an AWS Lambda policy used as a simple service checking the configuration of AWS infrastructure might be a good use case for resource constraints. Conversely, perhaps you applied the AdministratorAccess AWS-managed policy to an Instance Profile so that an EC2 instance can run Terraform to provision AWS resources via Infrastructure as Code. In the second example, the role is extremely permissive <strong>by design</strong> - and a tool can&#39;t automatically understand that context.</p> <p>As such, the tool aims to:</p> <ul> <li>Map out your risk landscape of IAM identity-based policies, enumerating the potential risks for a full IAM threat model</li> <li>Identify where you can reduce the blast radius in the case of credentials compromise</li> <li>Help you prioritize which ones to remediate</li> <li>Provide a straightforward workflow to remediate</li> <li>Provide a sufficient exclusions mechanism to programmatically define where deviations from resource constraints are by design</li> </ul> <h5 id="assessment-recap">Assessment Recap</h5> <p>To recap: you&#39;ve followed these steps to generate this report:</p> <ul> <li>Downloaded the Account Authorization details JSON file</li><ul> <li><code>cloudsplaining download --profile default --output default-account-details.json</code></li> </ul>  <li>Generated your custom exclusions file</li><ul> <li><code>cloudsplaining create-exclusions-file --output-file exclusions.yml</code></li> </ul>  <li>Generated the report <code>cloudsplaining scan --input-file default-account-details.json --exclusions-file exclusions.yml</code></li> <li>This generates (1) The single-file HTML report and the raw JSON data file</li> </ul> <h5 id="triaging-workflow">Triaging workflow</h5> <p>An assessor can follow this general workflow:</p> <ul> <li>Open a ticket in your organization&#39;s project management tool of choice (for example, JIRA or Salesforce) in the AWS account owner&#39;s project</li> <li>Attach the HTML report, JSON Data file, and CSV worksheet</li> <li>Ask the service/account owner team to fill out the Triage worksheet</li> </ul> <p>When you ask the service/account owner team to fill out the Triage CSV worksheet, you can use some text like the following:</p> <blockquote> <p>As part of our security assessment, our team ran Cloudsplaining on your AWS account. Cloudsplaining maps out the IAM risk landscape in a report, identifies where resource ARN constraints are not in use, and identifies other risks in IAM policies like Privilege Escalation, Data Exfiltration, and Resource Exposure/Permissions management. Remediating these issues, where applicable, will help to limit the blast radius in the case of compromised AWS credentials. We request that you review the HTML report and fill out the &quot;Justification&quot; field in the Triage worksheet. Based on the corresponding details in the HTML report, provide either (1) A justification on why the result is a False Positive, or (2) Identify that it is a legitimate finding.</p> </blockquote> <h5 id="triaging-considerations">Triaging considerations</h5> <p>When triaging your results, consider some of the factors listed below as you identify False Positives vs. legitimate findings. <strong>There are some scenarios where <code>&quot;Resource&quot;: &quot;*&quot;</code> access is by design and is therefore a false positive. This section covers some of the common scenarios.</strong></p> <p><strong>Infrastructure Creation roles</strong>:</p> <p> IAM roles that create infrastructure via Infrastructure as Code Technologies (for example, Terraform or CloudFormation) require high permission levels to provision AWS infrastructure. These will usually be false positives. When you see these instances, make sure that these roles are adequately protected. For instance, make sure that roles within the AWS account are not able to assume this role or affect its configuration in any way. Additionally, consider restricting the trust policy so that a set of explicitly stated IAM principals are the only ones who can assume that role. Take special care to audit instances of <code>sts:AssumeRole</code> within this AWS account.</p> <p><strong>System roles vs. User Roles</strong>: System roles - IAM Roles applied to compute services, such as EC2 Instance Profiles, ECS Task Execution roles, or Lambda Task Execution roles - should almost always leverage resource ARN constraints for actions that perform &quot;Write&quot; actions. Exceptions to this could include Infrastructure provisioning or other edge cases.</p> <p>Conversely, user roles will almost always be used against <code>*</code> resources for the sake of convenience, innovation, and avoiding overly restrictive limitations. In the user role scenario, consider:</p> <ul> <li><strong>Design context</strong>: is it appropriate? (For instance, maybe all your user roles don&#39;t need <code>iam:*</code>)</li> <li><strong>Environment</strong>: If this is a Dev environment, frequently-used user roles probably allow more permissions for innovation purposes. However, in later environments - especially production - commonly used user roles should be read-only - or the more permissive ones should be for break-glass scenarios only.</li> <li><strong>Regardless of the context</strong>: there should <strong>always</strong> be security guardrails in place, like <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scp.html">Service Control Policies through AWS Organizations</a> or <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_boundaries.html">IAM Permissions Boundaries</a> to prevent against egregious mistakes.</li> </ul> <p><strong>Organization-specific results</strong></p> <p>For example, perhaps you allow kms:Decrypt for * resources (by design) in your organization for one reason or another. Cloudsplaining flags this as a result. However, there are mitigating controls in place. Firstly, you leverage strict resource-based KMS key policies to lock down all KMS keys, explicitly stating individual IAM principals that are allowed to use them. Secondly, you provision all KMS keys with CloudFormation or Terraform, so you are confident that this pattern is consistent across all KMS keys in your AWS accounts. Therefore, <code>kms:Decrypt</code> to <code>*</code> resources is not a finding you are concerned about. In this case, you decide it is acceptable to exclude <code>kms:Decrypt</code> from your results.</p> <h5 id="common-false-positive-scenarios">Common False Positive Scenarios</h5> <p><strong>Conditions Logic</strong>:</p> <p>This tool does not evaluate <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_condition.html">IAM Conditions</a> logic. If your policies use wildcard resources but restrict according to condition keys, then it&#39;s possible this is a false positive. However, you might want to double-check the accuracy of the conditions logic in those IAM policies. While IAM conditions can be extremely powerful, implementation is also prone to human error. We suggest leveraging <a href="https://github.com/duo-labs/parliament/">Parliament by Duo Labs</a> (courtesy of <a href="https://twitter.com/0xdabbad00">Scott Piper</a>), to lint your policies for accuracy - especially when IAM conditions are in use.</p> <p><strong><code>logs:CreateLogGroup</code> and <code>logs:PutLogEvent</code></strong>:</p> <p>Depending on how your organization approaches CloudWatch Logs Agent configuration, IAM, and CloudWatch Logs Group naming conventions, it is sometimes near-impossible to prevent cross-contamination of logs or Log Injection to the Log Streams from other instance IDs. Cross-Contamination of CloudWatch Logs is an issue of its own that is definitely beyond the scope of this document - but consider this as a potential limitation by AWS when trying to identify a remediation plan.</p> <h5 id="building-the-exclusions-file">Building the Exclusions File</h5> <p>After you have identified the False Positives, add the False Positive criteria to your custom Cloudsplaining exclusions file. The False Positives generally fall into one of two categories:</p> <ul> <li>False positives that will occur across all of your AWS accounts, due to your organization-wide implementation strategy</li> <li>False positives specific to this AWS account</li> </ul> <p>To make the exclusions file, create a YAML file that we will use to list out exclusions with the <code>create-exclusions-file</code> command.</p> <pre><code class="language-bash">cloudsplaining create-exclusions-file</code></pre> <p>This will generate a file titled <code>exclusions.yml</code> in your current directory.</p> <p> The default exclusions file contains these contents:</p> <pre><code class="language-yaml"># Policy names to exclude from evaluation\n# Suggestion: Add policies here that are known to be overly permissive by design, after you run the initial report.\npolicies:\n  - &quot;AWSServiceRoleFor*&quot;\n  - &quot;*ServiceRolePolicy&quot;\n  - &quot;*ServiceLinkedRolePolicy&quot;\n  - &quot;AdministratorAccess&quot; # Otherwise, this will take a long time\n  - &quot;service-role*&quot;\n  - &quot;aws-service-role*&quot;\n# Don&#39;t evaluate these roles, users, or groups as part of the evaluation\nroles:\n  - &quot;service-role*&quot;\n  - &quot;aws-service-role*&quot;\nusers:\n  - &quot;&quot;\ngroups:\n  - &quot;&quot;\n# Read-only actions to include in the results, such as s3:GetObject\n# By default, it includes Actions that could lead to Data Exfiltration\ninclude-actions:\n  - &quot;s3:GetObject&quot;\n  - &quot;ssm:GetParameter&quot;\n  - &quot;ssm:GetParameters&quot;\n  - &quot;ssm:GetParametersByPath&quot;\n  - &quot;secretsmanager:GetSecretValue&quot;\n# Write actions to include from the results, such as kms:Decrypt\nexclude-actions:\n  - &quot;&quot;</code></pre> <p>Add whatever values you want to the above depending on your organization&#39;s context.</p> <ul> <li>Under <code>policies</code>, list the path of policy names that you want to exclude.</li> <li>If you want to exclude a role titled <code>MyRole</code>, list <code>MyRole</code> or <code>MyR*</code> in the <code>roles</code> list.</li> <li>You can follow the same approach for <code>users</code> and <code>groups</code> list.</li> </ul> <ul> <li>Now, run the scan to generate a <em>new</em> Cloudsplaining report that considers your exclusions criteria. This way, you are working with a report version that consists of True Positives only.</li> </ul> <pre><code class="language-bash">cloudsplaining scan --input-file default.json --exclusions-file exclusions.yml</code></pre> <p>You can now proceed to the Remediation stage.</p> ';e.exports=t},bb52:function(e,i,t){"use strict";t("caad"),t("ac1f"),t("8a79"),t("1276");var a=["ec2","eks","ecs-tasks","lambda"];function s(e,i){return e["roles"][i]["assume_role_policy"]["PolicyDocument"]}function o(e){var i,t=[];i=e["Statement"];for(var s=0;s<i.length;s++){var o=i[s];if(Object.prototype.hasOwnProperty.call(o,"Action"))if(Array.isArray(o["Action"])){if(!("sts:AssumeRole"in o["Action"]))return[]}else if("string"==typeof o["Action"]&&"sts:AssumeRole"!==o["Action"])return[];if(Object.prototype.hasOwnProperty.call(o,"Action")&&Object.prototype.hasOwnProperty.call(o["Principal"],"Service"))if(Array.isArray(o["Principal"]["Service"]))for(var n=0;n<o["Principal"]["Service"].length;n++){var r=o["Principal"]["Service"][n];if(r.endsWith(".amazonaws.com")){var l=r.split(".");l in a&&t.push(l)}}else if("string"==typeof o["Principal"]["Service"]){var c=o["Principal"]["Service"];if(c.endsWith(".amazonaws.com")){var d=c.split(".")[0];a.includes(d)&&t.push(d)}}}return t}i.getTrustPolicyDocumentForRole=s,i.trustPolicyAssumableByComputeService=o},e31a:function(e,i,t){var a=t("24fb");i=a(!1),i.push([e.i,"#main{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-align:left;color:#2c3e50}",""]),e.exports=i},e56f:function(e,i,t){"use strict";t("cb29"),t("4160"),t("caad"),t("a15b"),t("d81d"),t("b64b"),t("ac1f"),t("466d"),t("5319"),t("159b");var a=t("278c"),s=function(e){var i=Array(4).fill(0),t=a(i,4),s=t[0],o=t[1],n=t[2],r=t[3];return Object.keys(e).forEach((function(i){e[i]["PrivilegeEscalation"].length>0&&(s+=1),e[i]["DataExfiltration"].length>0&&(o+=1),e[i]["ResourceExposure"].length>0&&(n+=1),e[i]["InfrastructureModification"].length>0&&(r+=1)})),{PrivilegeEscalation:s,DataExfiltration:o,ResourceExposure:n,InfrastructureModification:r}};function o(e){return e=e.replace(/([a-z])([A-Z])/g,"$1 $2"),e=e.replace(/([A-Z])([A-Z][a-z])/g,"$1 $2"),e}function n(e){var i=function(e){return e&&e.match(/[A-Z]{2,}(?=[A-Z][a-z]+[0-9]*|\b)|[A-Z]?[a-z]+[0-9]*|[A-Z]|[0-9]+/g).map((function(e){return e.toLowerCase()})).join("_")};return i(e)}function r(e){var i=[];return e.forEach((function(e){i.includes(e)||i.push(e)})),i}function l(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(t,a){if(!t.hasOwnProperty(e)||!a.hasOwnProperty(e))return 0;var s="string"===typeof t[e]?t[e].toUpperCase():t[e],o="string"===typeof a[e]?a[e].toUpperCase():a[e],n=0;return s>o?n=1:s<o&&(n=-1),"desc"===i?-1*n:n}}i.policyViolations=s,i.addSpacesInPascalCaseString=o,i.compareValues=l,i.removeDuplicatesFromArray=r,i.convertStringToSnakeCase=n},e6d8:function(e,i){var t='<h5 id="validating-remediated-policies">Validating remediated policies</h5> <p>After you&#39;ve rewritten your IAM policy, we suggest two options for validating that it will pass Cloudsplaining and alleviate any remaining concerns:</p> <ul> <li>Run Cloudsplaining&#39;s <code>scan-policy-file</code> command, which scans a single JSON policy file instead of the entire AWS Account&#39;s Authorization details.</li> <li>Leveraging <a href="https://github.com/duo-labs/parliament/%22">Parliament by Duo-Labs</a>, courtesy of <a href="https://twitter.com/0xdabbad00">Scott Piper</a></li> </ul> <h5 id="using-cloudsplaining-to-validate-your-remediated-policies">Using Cloudsplaining to Validate your Remediated Policies</h5> <p>You can validate that your remediated policy passes Cloudsplaining by running the following command:</p> <p><code>cloudsplaining scan-policy-file --input-file policy.json --exclusions-file exclusions.yml</code></p> <p>When there are no more results, it passes!</p> <h5 id="using-parliament-to-lint-your-policies">Using Parliament to Lint your Policies</h5> <p>parliament is an AWS IAM linting library. It reviews policies looking for problems such as:</p> <ul> <li>malformed JSON</li> <li>missing required elements</li> <li>incorrect service prefix and action names</li> <li>incorrect resources or conditions for the actions provided</li> <li>type mismatches</li> <li>bad policy patterns</li> </ul> <p>This library duplicates (and adds to!) much of the functionality in the web console page when reviewing IAM policies in the browser.</p> <p>You can use Parliament to scan your IAM policy by visiting the Web Page! <a href="https://parliament.summitroute.com/">https://parliament.summitroute.com/</a></p> ';e.exports=t},f0d7:function(e,i){var t='<h5 id="prioritizing-remediation">Prioritizing Remediation</h5> <p>Depending on the existing workload of the engineering team addressing your concerns, the team might ask to address high priority items first rather than addressing all items, especially if the report is quite large. In this scenario, consider instructing the team to address High Priority Risks and the usage of AWS-Managed Policies first.</p> <p><strong>High priority risks</strong>:</p> <p>These include Privilege Escalation, Data Exfiltration, and Potential Resource Exposure/Permissions management. This report highlights each finding that has these high priority risks.</p> <p><strong>Moving from AWS Managed Policies over to custom policies</strong>:</p> <p>AWS managed policies always include access to <code>*</code> resources because AWS provides these same policies universally to all customer accounts. If this report flags any AWS-managed policies, it means that the account/service owner team will not only have to implement resource constraints - they will have to create a custom IAM policy to do so. To limit this work, it is best to migrate away from the root cause of the problem - using AWS managed policies.</p> <p>You can then queue the work for remediating the other Customer-managed policies that do not have the High-Priority Risks attributes. Implementing resource ARN constraints for True Positives is still important, since overly permissive &quot;Write&quot; actions can cause modification or deletion of AWS resources by a bad actor with compromised credentials, resulting in downtime.</p> <h5 id="remediating-the-findings">Remediating the Findings</h5> <p>We suggest two options for remediating each finding:</p> <ul> <li>Leveraging <a href="https://github.com/salesforce/policy_sentry/">Policy Sentry</a>, courtesy of <a href="https://twitter.com/kmcquade3">Kinnaird McQuade</a>, which generates policies with resource ARN constraints at user-specified access levels automagically.</li> <li>Manually rewriting the policies</li> </ul> <h6 id="leveraging-policy-sentry">Leveraging Policy Sentry</h6> <p>For guidance on how to use Policy Sentry, please see the documentation <a href="https://github.com/salesforce/policy_sentry/#writing-secure-policies-based-on-resource-constraints-and-access-levels">here</a>. This is highly suggested - within 10 minutes of learning the tool, creating a secure IAM policy becomes a matter of:</p> <ul> <li>Generating the YAML template with <code>policy_sentry create-template --output-file crud.yml --template-type crud</code></li> <li>Literally copying/pasting resource ARNs into the template</li> <li>Running <code>policy_sentry write-policy --input-file crud.yml</code></li> </ul> <h6 id="manually-rewriting-the-iam-policies">Manually rewriting the IAM Policies</h6> <p>For guidance on how to write secure IAM Policies by hand, see the tutorial <a href="https://engineering.salesforce.com/salesforce-cloud-security-automating-least-privilege-in-aws-iam-with-policy-sentry-b04fe457b8dc#6997">here</a>. Just be aware - you&#39;ll spend a lot of time looking at the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_actions-resources-contextkeys.html">AWS Documentation on IAM Actions, Resources, and Condition Keys</a>, which can become quite tedious and time-consuming.</p> ';e.exports=t}});
//# sourceMappingURL=app.bundle.js.map